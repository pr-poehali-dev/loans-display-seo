CREATE TABLE IF NOT EXISTS reviews (
    id SERIAL PRIMARY KEY,
    loan_id INTEGER NOT NULL,
    author_name VARCHAR(255) NOT NULL,
    rating INTEGER NOT NULL CHECK (rating >= 1 AND rating <= 5),
    comment TEXT NOT NULL,
    is_approved BOOLEAN NOT NULL DEFAULT false,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);

CREATE INDEX idx_reviews_loan_id ON reviews(loan_id);
CREATE INDEX idx_reviews_approved ON reviews(is_approved);
CREATE INDEX idx_reviews_created ON reviews(created_at DESC);

INSERT INTO reviews (loan_id, author_name, rating, comment, is_approved) VALUES
(1, 'Алексей М.', 5, 'Отличный сервис! Деньги пришли за 5 минут, без лишних вопросов. Первый займ под 0% - это вообще супер!', true),
(1, 'Мария К.', 4, 'Быстро одобрили, но процент после первого займа высоковат. В остальном всё хорошо.', true),
(1, 'Дмитрий П.', 5, 'Пользуюсь уже полгода, всегда выручают. Рекомендую!', true),
(2, 'Елена В.', 5, 'Самая простая анкета из всех, что я заполняла. Одобрили моментально!', true),
(2, 'Игорь С.', 4, 'Хороший сервис, но поддержка отвечает долго. Займ выдали быстро.', true),
(3, 'Ольга Н.', 5, 'Низкая ставка действительно радует. Взяла на месяц, переплата минимальная.', true),
(3, 'Сергей Л.', 5, 'Без проверки кредитной истории - это то, что нужно! Одобрили с плохой КИ.', true),
(3, 'Наталья Р.', 5, 'Деньги на карте через 3 минуты после одобрения. Очень быстро!', true),
(4, 'Андрей Ф.', 4, 'Крупную сумму дают не сразу, нужно сначала взять пару мелких займов. Но условия хорошие.', true),
(4, 'Виктория Б.', 5, 'Программа лояльности реально работает! Ставка снизилась после третьего займа.', true),
(5, 'Павел Т.', 5, 'Работают круглосуточно, взял займ в 2 часа ночи - всё прошло отлично!', true),
(5, 'Анна Ш.', 4, 'Без скрытых комиссий - это правда. Всё прозрачно и понятно.', true),
(6, 'Максим Д.', 4, 'Проверенная компания, работают давно. Условия стандартные, но надёжные.', true),
(6, 'Светлана Г.', 5, 'Гибкие условия погашения - можно продлить срок без проблем. Очень удобно!', true);